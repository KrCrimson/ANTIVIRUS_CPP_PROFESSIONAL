@startuml UNIFIED_ANTIVIRUS_Components
!theme aws-orange
title Diagrama de Componentes Detallado - UNIFIED ANTIVIRUS

skinparam component {
    BackgroundColor #FFF3E0
    BorderColor #F57C00
    FontColor #E65100
    FontSize 11
}

skinparam package {
    BackgroundColor #E3F2FD
    BorderColor #1976D2
    FontColor #1976D2
    FontSize 12
    FontStyle bold
}

' Interfaces principales
interface "IDetector" as IDetector
interface "IPlugin" as IPlugin
interface "IEventHandler" as IEventHandler
interface "INotification" as INotification

' Core Components
package "üèõÔ∏è CORE" {
    [üé≠ UnifiedEngine] as Engine
    [üì° EventBus] as EventBus
    [üéõÔ∏è PluginManager] as PluginManager
    [üìã PluginRegistry] as Registry
    [üîß ConfigManager] as ConfigManager
}

' UI Components
package "üíª INTERFACES" {
    [üñ•Ô∏è ProfessionalUI] as GUI
    [üì± LauncherCLI] as CLI
    [üìä AnalyticsView] as Analytics
    [‚öôÔ∏è ConfigurationPanel] as ConfigPanel
}

' Detector Plugins
package "üîç DETECTORS" {
    [üß† MLDetector] as MLDetector
    [üëÅÔ∏è BehaviorDetector] as BehaviorDetector  
    [üåê NetworkDetector] as NetworkDetector
    [üîç KeyloggerDetector] as KeyloggerDetector
}

' Handler Plugins
package "üö® HANDLERS" {
    [üö® AlertHandler] as AlertHandler
    [üõë ProcessBlocker] as ProcessBlocker
    [üì¶ QuarantineHandler] as QuarantineHandler
    [üìß EmailNotifier] as EmailNotifier
}

' Monitor Plugins
package "üëÅÔ∏è MONITORS" {
    [üìä SystemMonitor] as SystemMonitor
    [üîí FileWatcher] as FileWatcher
    [üåê NetworkMonitor] as NetworkMonitor
    [üìà PerformanceMonitor] as PerformanceMonitor
}

' External Dependencies
package "üîó EXTERNAL" {
    [ü§ñ ONNX Runtime] as ONNX
    [üíæ SQLite DB] as Database
    [üìÅ File System] as FileSystem
    [üåê Windows API] as WinAPI
}

' Implementaciones de interfaces
MLDetector ..|> IDetector
BehaviorDetector ..|> IDetector
NetworkDetector ..|> IDetector
KeyloggerDetector ..|> IDetector

AlertHandler ..|> IEventHandler
ProcessBlocker ..|> IEventHandler
QuarantineHandler ..|> IEventHandler

AlertHandler ..|> INotification
EmailNotifier ..|> INotification

' Conexiones principales
GUI --> Engine
CLI --> Engine
Engine --> PluginManager
Engine --> EventBus
Engine --> ConfigManager

PluginManager --> Registry
PluginManager --> MLDetector
PluginManager --> BehaviorDetector
PluginManager --> NetworkDetector
PluginManager --> KeyloggerDetector

PluginManager --> AlertHandler
PluginManager --> ProcessBlocker
PluginManager --> QuarantineHandler

EventBus --> AlertHandler
EventBus --> GUI
EventBus --> Analytics

' Dependencias externas
MLDetector --> ONNX
Engine --> Database
FileWatcher --> FileSystem
NetworkDetector --> WinAPI
BehaviorDetector --> WinAPI

' Configuraci√≥n
ConfigManager --> ConfigPanel
ConfigManager --> Database

note as N1
**Patrones Implementados:**
‚Ä¢ Facade Pattern (Engine)
‚Ä¢ Observer Pattern (EventBus)
‚Ä¢ Factory Pattern (PluginManager)
‚Ä¢ Strategy Pattern (Detectores)
‚Ä¢ Command Pattern (Handlers)
end note

note as N2
**Caracter√≠sticas Clave:**
‚Ä¢ Arquitectura Plugin-based
‚Ä¢ Comunicaci√≥n desacoplada
‚Ä¢ Extensibilidad modular
‚Ä¢ Threading as√≠ncrono
‚Ä¢ Configuraci√≥n din√°mica
end note

@enduml