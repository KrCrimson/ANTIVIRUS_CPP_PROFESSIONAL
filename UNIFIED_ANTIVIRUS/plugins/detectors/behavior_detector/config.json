{
  "plugin_info": {
    "name": "behavior_detector",
    "version": "2.0.0",
    "description": "Detector comportamental INTELIGENTE - No obvio",
    "author": "Sistema Anti-Keylogger Unificado",
    "category": "detectors",
    "priority": 2
  },
  "behavior_config": {
    "risk_threshold": 0.7,
    "enable_whitelist": true,
    "enable_advanced_analysis": true,
    "enable_intelligence_engine": true,
    "analysis_timeout_ms": 10000,
    "use_unified_intelligence": true
  },
  "intelligent_detection": {
    "masquerading_detection": {
      "enable": true,
      "system_process_mimics": [
        "svchost",
        "csrss",
        "winlogon"
      ],
      "location_verification": true,
      "weight": 0.35
    },
    "stealth_location_analysis": {
      "enable": true,
      "high_risk_locations": [
        "windows\\fonts",
        "windows\\system32\\spool\\drivers",
        "recycler"
      ],
      "weight": 0.25
    },
    "behavioral_patterns": {
      "memory_analysis": true,
      "thread_analysis": true,
      "handle_monitoring": true,
      "network_behavior": true,
      "weight": 0.25
    },
    "api_context_analysis": {
      "contextualize_api_calls": true,
      "legitimate_use_detection": true,
      "weight": 0.15
    }
  },
  "whitelist": {
    "gaming_platforms": [
      "steam",
      "epic",
      "origin"
    ],
    "development_tools": [
      "code.exe",
      "devenv.exe"
    ],
    "browsers": [
      "chrome.exe",
      "firefox.exe",
      "edge.exe"
    ],
    "trusted_publishers": [
      "Microsoft Corporation",
      "Google LLC",
      "Valve Corporation"
    ]
  },
  "detection_rules": {
    "process_behavior": {
      "enable_intelligence_engine": true,
      "use_behavioral_analysis": true,
      "dangerous_apis": [
        "SetWindowsHookEx",
        "GetAsyncKeyState", 
        "CallNextHookEx",
        "RegisterHotKey",
        "GetClipboardData"
      ]
    },
    "network_behavior": {
      "data_exfiltration_patterns": [],
      "command_control_patterns": []
    },
    "file_behavior": {
      "keylogger_file_patterns": []
    },
    "system_behavior": {}
  },
  "risk_scoring": {
    "weights": {
      "behavioral_analysis": 0.9,
      "process_masquerading": 0.8,
      "stealth_location": 0.7,
      "suspicious_command_line": 0.6,
      "api_hooking": 0.9,
      "external_communication": 0.4,
      "credential_file_access": 0.5,
      "registry_modification": 0.6
    },
    "thresholds": {
      "low_risk": 0.3,
      "medium_risk": 0.5,
      "high_risk": 0.7,
      "critical_risk": 0.9
    }
  },
  "legacy_patterns_disabled": {
    "note": "Patrones obvios deshabilitados - usando inteligencia comportamental",
    "disabled_patterns": [
      ".*keylog.*",
      ".*spyware.*",
      ".*stealer.*",
      ".*passwords?.txt$",
      ".*credentials?.txt$"
    ]
  }
}