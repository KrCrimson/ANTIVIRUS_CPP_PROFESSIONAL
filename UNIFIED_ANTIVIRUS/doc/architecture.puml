@startuml UNIFIED_ANTIVIRUS_Architecture
!theme aws-orange
title UNIFIED ANTIVIRUS - Arquitectura del Sistema Anti-Keylogger

' Definir colores y estilos
skinparam backgroundColor #F8F9FA
skinparam package {
    BackgroundColor #E3F2FD
    BorderColor #1976D2
    FontColor #1976D2
    FontSize 12
}
skinparam component {
    BackgroundColor #FFF3E0
    BorderColor #F57C00
    FontColor #E65100
}
skinparam interface {
    BackgroundColor #E8F5E8
    BorderColor #4CAF50
    FontColor #2E7D32
}
skinparam actor {
    BackgroundColor #FCE4EC
    BorderColor #E91E63
    FontColor #C2185B
}

' Actores
actor "üë§ Usuario" as User

' Capa de Presentaci√≥n
package "üíª INTERFAZ DE USUARIO" as UI {
    component "üñ•Ô∏è GUI Dashboard" as Dashboard
    component "üìä An√°lisis & Gr√°ficos" as Analytics
    component "‚öôÔ∏è Configuraci√≥n" as Config
    component "üì± CLI Interface" as CLI
}

' Capa de Control Principal
package "üèõÔ∏è MOTOR PRINCIPAL (ENGINE)" as Engine {
    component "üé≠ Unified Engine\n(Facade Pattern)" as MainEngine
    component "üì° Event Bus\n(Observer Pattern)" as EventBus
    component "üéõÔ∏è Plugin Manager\n(Factory Pattern)" as PluginManager
    component "üìã Plugin Registry" as Registry
}

' Capa de Detectores
package "üîç DETECTORES ESPECIALIZADOS" as Detectors {
    component "üß† ML Detector\n‚Ä¢ Modelo ONNX\n‚Ä¢ 47 Features\n‚Ä¢ 85% Precisi√≥n" as MLDetector
    component "üëÅÔ∏è Behavior Detector\n‚Ä¢ CPU/RAM Usage\n‚Ä¢ I/O Patterns\n‚Ä¢ Process Hooks" as BehaviorDetector
    component "üåê Network Detector\n‚Ä¢ Conexiones\n‚Ä¢ Puertos\n‚Ä¢ Traffic DPI" as NetworkDetector
    component "üîç Keylogger Detector\n‚Ä¢ Firmas Malware\n‚Ä¢ API Hooks\n‚Ä¢ Heur√≠sticas" as KeyloggerDetector
}

' Capa de Decisi√≥n
package "üéØ SISTEMA DE DECISI√ìN" as Decision {
    component "üìä Threat Analyzer\n(Strategy Pattern)" as ThreatAnalyzer
    component "‚öñÔ∏è Decision Engine" as DecisionEngine
    component "üßÆ Scoring System" as ScoringSystem
}

' Capa de Respuesta
package "üö® SISTEMA DE RESPUESTA" as Response {
    component "üö® Alert Manager" as AlertManager
    component "üõë Process Blocker" as ProcessBlocker
    component "üì¶ Quarantine System" as QuarantineSystem
    component "üìä Report Generator" as ReportGenerator
}

' Configuraci√≥n
package "‚öôÔ∏è CONFIGURACI√ìN & PERFILES" as Configuration {
    component "üè† Perfil Dom√©stico" as HomeProfile
    component "üè¢ Perfil Empresarial" as BusinessProfile
    component "üéÆ Perfil Gaming" as GamingProfile
    component "üîß Configuraci√≥n Custom" as CustomConfig
}

' Conexiones principales
User --> UI
UI --> MainEngine

MainEngine --> EventBus
MainEngine --> PluginManager
PluginManager --> Registry

' Conectar detectores
PluginManager --> MLDetector
PluginManager --> BehaviorDetector
PluginManager --> NetworkDetector
PluginManager --> KeyloggerDetector

' Flujo de datos hacia decisi√≥n
MLDetector --> ThreatAnalyzer
BehaviorDetector --> ThreatAnalyzer
NetworkDetector --> ThreatAnalyzer
KeyloggerDetector --> ThreatAnalyzer

ThreatAnalyzer --> DecisionEngine
DecisionEngine --> ScoringSystem

' Sistema de respuesta
DecisionEngine --> AlertManager
DecisionEngine --> ProcessBlocker
DecisionEngine --> QuarantineSystem
DecisionEngine --> ReportGenerator

' Configuraci√≥n
Configuration --> MainEngine

' Event Bus connections (bidireccionales)
EventBus <--> ThreatAnalyzer
EventBus <--> AlertManager
EventBus <--> Dashboard

note right of MainEngine
  **Facade Pattern**
  - Simplifica interfaz compleja
  - Coordina todos los componentes
  - Punto de entrada √∫nico
end note

note bottom of ThreatAnalyzer
  **An√°lisis Inteligente**
  - Combina 4 detectores
  - Scoring ponderado
  - Decisi√≥n por consenso
end note

note left of MLDetector
  **Inteligencia Artificial**
  - Red neuronal entrenada
  - An√°lisis de 47 caracter√≠sticas
  - Inferencia en tiempo real
end note

@enduml